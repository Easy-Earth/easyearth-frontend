/* --- [1] 디자인 시스템 변수 --- */
:root {
  --color-common: #94a3b8;
  --color-rare: #3b82f6;
  --color-epic: #8b5cf6;
  --color-legendary: #f59e0b;
}

/* --- [2] 핵심 애니메이션 --- */
@keyframes spin { to { transform: rotate(360deg); } }
@keyframes sweep { 0% { left: -150%; } 25% { left: 150%; } 100% { left: 150%; } }
@keyframes starShower {
  0% { transform: translate(0, 0); opacity: 0; }
  10% { opacity: 1; }
  40% { transform: translate(-100px, 100px); opacity: 0; }
  100% { transform: translate(-100px, 100px); opacity: 0; }
}
@keyframes epicBloom { from { filter: brightness(1) saturate(1); } to { filter: brightness(1.3) saturate(1.2); } }
@keyframes legendaryRainbow { 0% { filter: hue-rotate(0deg); } 100% { filter: hue-rotate(360deg); } }
@keyframes legendaryFlow { to { background-position: 200% center; } }
@keyframes pulseFloat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }

/* [추가] 전설용 색상 순환 애니메이션 */
@keyframes legendaryColorShift {
  0% { filter: hue-rotate(0deg) brightness(1); }
  50% { filter: hue-rotate(30deg) brightness(1.2); }
  100% { filter: hue-rotate(0deg) brightness(1); }
}

/* --- [3] 공통 배경 효과 (Background/Profile용) --- */
.fx-badge-card { position: relative; width: 100%; height: 100%; overflow: hidden; display: flex; align-items: center; justify-content: center; z-index: 1; }
.fx-bg-black { background: #000; }

.fx-glow {
  position: absolute; inset: -20%; z-index: 0;
  background: radial-gradient(circle at 20% 30%, var(--g1), transparent 55%),
              radial-gradient(circle at 80% 35%, var(--g2), transparent 60%);
}

.fx-bg-only .fx-glow {
  background: radial-gradient(circle at 20% 30%, var(--g1), transparent 55%),
              radial-gradient(circle at 80% 35%, var(--g2), transparent 60%),
              linear-gradient(135deg, rgba(12, 18, 28, 0.96), rgba(8, 30, 34, 0.94));
}

.fx-epic-glow { animation: epicBloom 3s ease-in-out infinite alternate; }

/* [수정] 전설 등급 전체에 색상 변화 적용 */
.rarity-legendary.fx-bg-only { 
  animation: legendaryColorShift 8s ease-in-out infinite; 
}
.fx-legendary-rainbow { animation: legendaryRainbow 8s linear infinite; }

/* 끊겼던 부분부터 다시 시작 */
.fx-rays {
  position: absolute; inset: -60%; z-index: 1;
  background: conic-gradient(from 0deg, 
    transparent 0deg, var(--ring) 45deg, 
    transparent 90deg, var(--g1) 135deg, 
    transparent 180deg, var(--ring) 225deg, 
    transparent 270deg, var(--g2) 315deg, 
    transparent 360deg);
  opacity: 0.7; 
  filter: blur(15px); /* [추가] 도형 느낌을 없애기 위한 블러 처리 */
  animation: spin 10s linear infinite; /* [수정] 속도를 늦춰서 어색함 제거 */
}

/* Common/Rare에서는 rays 안보이게 처리 */
.rarity-common .fx-rays { display: none; }

@keyframes legendaryColorShift {

  0% { filter: hue-rotate(0deg) brightness(1.1); }   /* 시작 색상 (원래 색) */

  50% { filter: hue-rotate(180deg) brightness(1.2); } /* 반대편 색상으로 전이 */

  100% { filter: hue-rotate(360deg) brightness(1.1); } /* 다시 원래 색으로 복귀 */

}

/* --- [4] 칭호 영역 효과 (Title 전용) --- */
.fx-title-area { 
  position: relative; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  z-index: 15; 
  border-radius: 12px; 
  padding: 8px 16px;
  overflow: hidden; 
  transition: all 0.3s; 
}

.fx-main-title { 
  font-family: 'GmarketSansBold', sans-serif; 
  font-weight: 900; 
  z-index: 10; 
  text-align: center;
  font-size: 1.1rem;
}

/* 등급별 칭호 스타일 */
.rarity-common .fx-title-area { background: rgba(0, 0, 0, 0.05); border: 1px solid rgba(0, 0, 0, 0.1); }
.rarity-common .fx-main-title { color: #334155; }

.rarity-rare .fx-title-area { 
  background: linear-gradient(135deg, rgba(0,0,0,0.6), rgba(var(--ring-rgb), 0.2)); 
  border: 1.5px solid var(--ring); box-shadow: 0 0 15px var(--ring); 
}
.rarity-rare .fx-main-title { color: #fff; text-shadow: 0 0 8px var(--ring); }

.rarity-epic .fx-title-area {
  background: linear-gradient(45deg, #0f0c29, #302b63, #24243e); border: 1.5px solid #fff;
  box-shadow: 0 0 20px var(--ring); animation: epicBloom 3s infinite alternate;
}
.rarity-epic .fx-title-area::after {
  content: ""; position: absolute; top: 0; left: -150%; width: 50%; height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
  transform: skewX(-30deg); animation: sweep 4s infinite;
}
.rarity-epic .fx-main-title { color: #fff; text-shadow: 0 0 10px #fff, 0 0 20px var(--ring); }

.rarity-legendary .fx-title-area { background: #000; border: 2px solid #fff; box-shadow: 0 0 30px var(--ring); }
.rarity-legendary .fx-title-area::after {
  content: ""; position: absolute; top: -100px; left: -50px; width: 200%; height: 200%;
  background-image: linear-gradient(45deg, #fff 0%, transparent 10%); background-size: 4px 60px;
  animation: starShower 2s linear infinite;
}
.rarity-legendary .fx-main-title {
  background: linear-gradient(to right, #fff, var(--ring), var(--g1), #fff);
  background-size: 200% auto; -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  animation: legendaryFlow 2s linear infinite; filter: drop-shadow(0 0 12px var(--ring));
}

/* --- [5] 모달/그리드 카드용 등급별 배경 및 테두리 --- */
.bg-common { background: linear-gradient(135deg, #f1f5f9 0%, #cbd5e1 100%) !important; }
.bg-rare { background: linear-gradient(135deg, #eff6ff 0%, #3b82f6 100%) !important; }
.bg-epic { background: linear-gradient(135deg, #faf5ff 0%, #8b5cf6 100%) !important; }
.bg-legendary { background: linear-gradient(135deg, #fffbeb 0%, #f59e0b 100%) !important; }

/* 카드 테두리 효과 */
.border-common { border: 2px solid #cbd5e1; }
.border-rare { border: 2px solid #3b82f6; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2); }
.border-epic { border: 2px solid #8b5cf6; box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3); }
.border-legendary { 
  border: 2px solid #f59e0b; 
  box-shadow: 0 0 20px rgba(245, 158, 11, 0.4); 
  animation: epicBloom 2s infinite alternate;
}

/* 전설 등급 펄싱 효과 (이미지용) */
.fx-pulse { animation: pulseFloat 2s infinite ease-in-out; }

/* 전설 모달용 특수 테두리 */
.fx-legendary-border {
  border: 2px solid #f59e0b !important;
  box-shadow: 0 0 30px rgba(245, 158, 11, 0.5), inset 0 0 15px rgba(245, 158, 11, 0.2) !important;
}


/* --- [4] 칭호 영역 효과 (Title 전용) --- */
/* 기존 .rarity- 를 모두 .t-rarity- 로 변경하여 부모 배경 등급과 분리합니다. */

/* [수정] Common 등급 칭호 강제 적용 */


/* [수정] Common 등급 글자 강제 적용 */
.t-rarity-common .fx-main-title,
[class*="rarity-common"] .fx-main-title { 
  color: #ffffff !important;                /* 무조건 흰색 */
  text-shadow: none !important;
  opacity: 1 !important;                     /* 흐릿하게 보이지 않도록 */
}


.t-rarity-epic .fx-title-area {
  background: linear-gradient(45deg, #0f0c29, #302b63, #24243e); border: 1.5px solid #fff;
  box-shadow: 0 0 20px var(--ring); animation: epicBloom 3s infinite alternate;
}
.t-rarity-epic .fx-title-area::after {
  content: ""; position: absolute; top: 0; left: -150%; width: 50%; height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
  transform: skewX(-30deg); animation: sweep 4s infinite;
}
.t-rarity-epic .fx-main-title { color: #fff; text-shadow: 0 0 10px #fff, 0 0 20px var(--ring); }

.t-rarity-legendary .fx-title-area { 
  background: #000; 
  border: 2px solid #fff; 
  /* 겉과 안 모두 번쩍이게 수정 */
  box-shadow: 0 0 35px var(--ring), inset 0 0 15px var(--ring); 
}
.t-rarity-legendary .fx-title-area::after {
  content: ""; position: absolute; top: -100px; left: -50px; width: 200%; height: 200%;
  background-image: linear-gradient(45deg, #fff 0%, transparent 10%); background-size: 4px 60px;
  animation: starShower 2s linear infinite;
}
.t-rarity-legendary .fx-main-title {
  background: linear-gradient(to right, #fff, var(--ring), var(--g1), #fff);
  background-size: 200% auto;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: legendaryFlow 2s linear infinite;
  filter: drop-shadow(0 0 12px var(--ring));
}

/* --- [6] 배경 분리 레이어 스타일 (Profile.jsx 구조용) --- */

/* 배경 효과들만 담는 그릇: 부모 크기를 꽉 채우고 뒤로 보냅니다. */
.fx-background-layer {
  position: absolute;
  inset: 0;
  z-index: 0; 
  overflow: hidden;
  border-radius: inherit; /* 부모인 profileContainer의 둥근 모서리를 그대로 상속 */
}

/* [핵심] 전설 등급 배경에만 색상 순환 애니메이션 적용 */
/* 부모가 아닌 이 레이어에 filter를 걸어야 내부의 배지/텍스트가 영향을 안 받습니다. */
.fx-background-layer.rarity-legendary {
  animation: legendaryColorShift 8s ease-in-out infinite;
}

/* 배경 레이어 내부의 광원/빛줄기 위치 고정 */
.fx-background-layer .fx-glow,
.fx-background-layer .fx-rays {
  position: absolute;
}

/* z-index 관리: 배경은 0, 실제 콘텐츠는 Profile.module.css에서 높은 값을 갖게 됩니다. */
/* Rare 등급일 때 빛줄기(rays) 보이기 설정 */
.rarity-rare .fx-rays { 
  display: block !important; 
  opacity: 0.35;             /* Epic보다 낮게 설정하여 은은한 느낌 */
  filter: blur(20px);       /* 부드러운 안개 느낌을 위해 블러 강화 */
  animation: spin 20s linear infinite; /* 매우 느리게 회전하여 정적인 고급스러움 강조 */
}

/* Rare 등급 배경 전체에 미세한 숨쉬기(Pulse) 효과 */
.fx-background-layer.rarity-rare {
  animation: rareGlowPulse 5s ease-in-out infinite alternate;
}

@keyframes rareGlowPulse {
  from { filter: brightness(0.9) contrast(1.1); }
  to { filter: brightness(1.1) contrast(1.2); }
}

/* Common */

.t-rarity-common .fx-title-area { 
  background: rgba(0, 0, 0, 0.2) !important; 
  border: 1px solid rgba(255, 255, 255, 0.3) !important; 
}
.t-rarity-common .fx-main-title { color: #ffffff !important; text-shadow: none !important; }

/* Rare */
.t-rarity-rare .fx-title-area { 
  background: rgba(255, 255, 255, 0.15) !important; /* 배경이 비치도록 투명도 조절 */
  backdrop-filter: blur(4px); /* 뒤 배경을 살짝 흐리게 */
  border: 1.5px solid var(--ring) !important; 
  box-shadow: 0 0 15px var(--ring) !important;
}
.t-rarity-rare .fx-main-title { color: #ffffff !important; text-shadow: 0 0 8px #3b82f6 !important; }

/* Epic */
.t-rarity-epic .fx-title-area {
  background: linear-gradient(45deg, #0f0c29, #302b63, #24243e) !important;
  border: 1.5px solid #fff !important;
  box-shadow: 0 0 20px var(--ring) !important;
}

/* Legendary */
.t-rarity-legendary .fx-title-area { 
  background: #000 !important; 
  border: 2px solid #fff !important; 
  box-shadow: 0 0 35px var(--ring) !important; 
}

/* 배경 효과 레이어 정의 */
.fx-background-layer {
  position: absolute;
  inset: 0;
  z-index: 0;
  overflow: hidden;
  border-radius: inherit;
}

/* 색상 변화 애니메이션을 부모가 아닌 이 레이어에만 적용 */
.fx-background-layer.rarity-legendary {
  animation: legendaryColorShift 8s ease-in-out infinite !important;
}

/* 칭호 영역이 배경의 filter(색변화)에 영향받지 않도록 고정 */
.fx-title-area {
  filter: none !important;
}

/* Common/Rare일 때 상점 카드처럼 보이게 Rays 끄기 */
.rarity-common .fx-rays, .rarity-rare .fx-rays {
  display: none !important;
}
/* 아이템 카드(상점/인벤토리) 전용 배경 컨테이너 */
.item-card-bg-container {
  position: absolute;
  inset: 0;
  z-index: 0;
  overflow: hidden;
  background: #111827; /* 기본 어두운 베이스 */
}

/* 프로필과 동일한 은은한 광원 효과 */
.item-card-glow {
  position: absolute;
  inset: -20%;
  background: radial-gradient(circle at 30% 30%, var(--g1), transparent 70%),
              radial-gradient(circle at 70% 70%, var(--g2), transparent 70%);
  opacity: 0.6; /* 너무 밝지 않게 조절 */
  filter: blur(40px); /* 뒤가 뿌옇게 보이도록 블러 강화 */
}

/* Rare 등급 이상일 때 아주 미세한 색상 넣기 */
.item-card-bg-container.rarity-rare .item-card-glow { opacity: 0.7; }
.item-card-bg-container.rarity-epic .item-card-glow { opacity: 0.8; }